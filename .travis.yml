sudo: false

language: c

compiler:
  - gcc

addons:
  apt:
    packages:
      - gfortran
      - libopenblas-dev
      - liblapack-dev
      - libopenmpi-dev
      - openmpi-bin

env:
  - BUILD=cmake
  - BUILD=configure

before_script:
  - if [ "$BUILD" == "cmake" ]; then mkdir build ; fi
  - if [ "$BUILD" == "cmake" ]; then cd build ; fi
  - if [ "$BUILD" == "cmake" ]; then cmake -D EXAMPLES=ON .. ; fi

script:
  # CMAKE
  - if [ "$USE_CMAKE" == "true" ]; then make ; fi
  # CONFIGURE
  - if [ "$USE_CMAKE" == "false" ]; then ./bootstrap ; fi
  - if [ "$USE_CMAKE" == "false" ]; then ./configure --enable-mpi ; fi
  - if [ "$USE_CMAKE" == "false" ]; then make all ; fi
  - if [ "$USE_CMAKE" == "false" ]; then make check ; fi
  - if [ "$USE_CMAKE" == "false" ]; then make distcheck ; fi
